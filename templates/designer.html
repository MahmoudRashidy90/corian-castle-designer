<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙƒÙˆØ±ÙŠØ§Ù† ÙƒØ§Ø³ÙŠÙ„ - ØµÙ…Ù… Ø¨Ù†ÙØ³Ùƒ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); color: #fff; min-height: 100vh; line-height: 1.6; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .header { background: rgba(196, 150, 90, 0.1); padding: 15px 0; border-bottom: 1px solid rgba(196, 150, 90, 0.3); position: sticky; top: 0; z-index: 100; }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo h2 { color: #C4965A; font-size: 1.8rem; }
        .back-btn { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(196, 150, 90, 0.3); color: #C4965A; padding: 10px 20px; border-radius: 25px; text-decoration: none; }
        .page-title { text-align: center; margin: 40px 0; }
        .page-title h1 { font-size: 2.8rem; background: linear-gradient(45deg, #C4965A, #D4A574); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .page-title .subtitle { font-size: 1.4rem; color: #C4965A; margin-bottom: 15px; font-weight: bold; }
        .design-choice { background: rgba(255, 255, 255, 0.05); border: 2px solid rgba(196, 150, 90, 0.3); border-radius: 20px; padding: 30px; margin: 30px auto; max-width: 600px; }
        .choice-buttons { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; }
        .choice-btn { border: none; padding: 20px 30px; border-radius: 15px; cursor: pointer; font-weight: bold; font-size: 1.1rem; min-width: 200px; text-align: center; }
        .choice-btn.active { background: linear-gradient(45deg, #C4965A, #D4A574); color: #1a1a1a; }
        .choice-btn:not(.active) { background: rgba(255,255,255,0.1); color: #C4965A; border: 2px solid rgba(196,150,90,0.3); }
        .ai-section { background: linear-gradient(135deg, rgba(196, 150, 90, 0.15), rgba(196, 150, 90, 0.05)); border: 2px solid rgba(196, 150, 90, 0.4); border-radius: 20px; padding: 30px; margin: 30px 0; text-align: center; display: block; }
        .ai-prompt { width: 100%; padding: 18px; background: rgba(255, 255, 255, 0.12); border: 2px solid rgba(196, 150, 90, 0.4); border-radius: 15px; color: #fff; margin: 20px 0; min-height: 120px; resize: vertical; font-size: 1rem; }
        .ai-generate-btn { background: linear-gradient(45deg, #C4965A, #D4A574); color: #1a1a1a; border: none; padding: 20px 50px; border-radius: 50px; font-size: 1.3rem; font-weight: bold; cursor: pointer; }
        .ai-result { margin-top: 30px; padding: 25px; background: rgba(255, 255, 255, 0.08); border-radius: 15px; display: none; }
        .ai-result.show { display: block; }
        .form-container { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(196, 150, 90, 0.3); border-radius: 20px; padding: 40px; margin: 30px 0; display: none; }
        .form-container.show { display: block; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .form-group { margin-bottom: 25px; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label { display: block; color: #C4965A; font-weight: bold; margin-bottom: 8px; font-size: 1.1rem; }
        .form-control { width: 100%; padding: 15px; background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(196, 150, 90, 0.3); border-radius: 10px; color: #fff; font-size: 1rem; }
        .form-control:focus { outline: none; border-color: #C4965A; background: rgba(255, 255, 255, 0.15); }
        .dimension-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .drawing-section { background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; margin: 15px 0; }
        .canvas-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .brush-controls { display: flex; gap: 10px; align-items: center; }
        .brush-controls label { color: #333; margin: 0; font-size: 0.9rem; }
        .canvas-actions { display: flex; gap: 10px; }
        .action-btn { background: #ef4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; }
        .action-btn.save { background: #10b981; }
        #drawingCanvas { border: 2px solid #C4965A; border-radius: 10px; cursor: crosshair; background: white; max-width: 100%; display: block; margin: 0 auto; }
        .btn-primary { background: linear-gradient(45deg, #C4965A, #D4A574); color: #1a1a1a; border: none; padding: 18px 40px; border-radius: 50px; font-size: 1.2rem; font-weight: bold; cursor: pointer; display: block; margin: 30px auto; }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }
        .api-status { position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.9); padding: 10px 15px; border-radius: 10px; z-index: 1000; font-size: 12px; }
        .api-status.connected { border-left: 4px solid #4CAF50; }
        .api-status.error { border-left: 4px solid #f44336; }
        .api-status.warning { border-left: 4px solid #ff9800; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) { .form-grid { grid-template-columns: 1fr; } .dimension-inputs { grid-template-columns: 1fr; } .choice-buttons { flex-direction: column; } }
    </style>
</head>
<body>
    <!-- API Status -->
    <div class="api-status warning" id="apiStatus">
        ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...
    </div>

    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo"><h2>ÙƒÙˆØ±ÙŠØ§Ù† ÙƒØ§Ø³ÙŠÙ„</h2></div>
                <a href="/" class="back-btn"><i class="fas fa-arrow-right"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="page-title">
                <h1>ÙƒÙˆØ±ÙŠØ§Ù† ÙƒØ§Ø³ÙŠÙ„</h1>
                <p class="subtitle">Ø§Ù„Ø®ÙŠØ§Ù„ Ø¹Ù„ÙŠÙƒ ... ÙˆØ§Ù„ÙˆØ§Ù‚Ø¹ Ø¹Ù„ÙŠÙ†Ø§</p>
                
                <div class="design-choice">
                    <h3 style="color: #C4965A; text-align: center; margin-bottom: 20px;">ğŸ¨ Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØµÙ…ÙŠÙ…</h3>
                    <div class="choice-buttons">
                        <button id="chooseAI" class="choice-btn active" onclick="chooseMethod('ai')">
                            ğŸ¤– Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ<br><small>Ø³Ø±ÙŠØ¹ - 30 Ø«Ø§Ù†ÙŠØ©</small>
                        </button>
                        <button id="chooseDraw" class="choice-btn" onclick="chooseMethod('draw')">
                            âœï¸ Ø±Ø³Ù… ÙŠØ¯ÙˆÙŠ<br><small>Ø¥Ø¨Ø¯Ø§Ø¹ Ø´Ø®ØµÙŠ</small>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… AI -->
            <div class="ai-section" id="aiSection">
                <h3 style="color: #C4965A; margin-bottom: 15px;">ğŸ¤– Ù…ÙˆÙ„Ø¯ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
                <p style="color: rgba(255,255,255,0.9); margin-bottom: 25px;">Ø§ÙƒØªØ¨ ÙˆØµÙ ØªØµÙ…ÙŠÙ…Ùƒ ÙˆØ³Ù†Ø­ÙˆÙ„Ù‡ Ù„ØµÙˆØ±Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</p>
                
                <textarea id="aiPrompt" class="ai-prompt" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø·Ø¨Ø® Ø¹ØµØ±ÙŠ Ø¨ÙƒØ§ÙˆÙ†ØªØ± ÙƒÙˆØ±ÙŠØ§Ù† Ø£Ø¨ÙŠØ¶ Ù„Ø§Ù…Ø¹ØŒ Ø®Ø²Ø§Ø¦Ù† Ø±Ù…Ø§Ø¯ÙŠØ©ØŒ Ø¥Ø¶Ø§Ø¡Ø© LED Ø¯Ø§ÙØ¦Ø©ØŒ ØªØµÙ…ÙŠÙ… Ù…ÙŠÙ†ÙŠÙ…Ø§Ù„ Ø­Ø¯ÙŠØ«"></textarea>
                
                <button class="ai-generate-btn" onclick="generateAI()">
                    <i class="fas fa-magic"></i> ÙˆÙ„Ù‘Ø¯ Ø§Ù„ØªØµÙ…ÙŠÙ…
                </button>
                
                <div class="ai-result" id="aiResult">
                    <div id="aiImageContainer"></div>
                </div>
            </div>

            <!-- Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
            <form id="designForm" class="form-container">
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Ø§Ù„Ø§Ø³Ù… <span style="color: #ff6b6b;">*</span></label>
                        <input type="text" id="customerName" class="form-control" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…" required>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                        <select id="location" class="form-control">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
                            <option value="Ø­ÙˆÙ„ÙŠ">Ø­ÙˆÙ„ÙŠ</option>
                            <option value="Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ">Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ</option>
                            <option value="Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©">Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©</option>
                            <option value="Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡">Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡</option>
                            <option value="Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„ÙƒØ¨ÙŠØ±">Ù…Ø¨Ø§Ø±Ùƒ Ø§Ù„ÙƒØ¨ÙŠØ±</option>
                            <option value="Ø§Ù„Ø¹Ø§ØµÙ…Ø©">Ø§Ù„Ø¹Ø§ØµÙ…Ø©</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ÙˆØ§ØªØ³Ø§Ø¨ <span style="color: #ff6b6b;">*</span></label>
                        <input type="tel" id="whatsapp" class="form-control" placeholder="96599123456" required>
                    </div>
                    <div class="form-group">
                        <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬ <span style="color: #ff6b6b;">*</span></label>
                        <select id="projectType" class="form-control" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                            <option value="Ù…Ø·Ø¨Ø®">Ù…Ø·Ø¨Ø®</option>
                            <option value="Ù…ØºØ³Ù„Ø©">Ù…ØºØ³Ù„Ø©</option>
                            <option value="ÙƒØ§ÙˆÙ†ØªØ±">ÙƒØ§ÙˆÙ†ØªØ±</option>
                            <option value="Ø¯ÙˆÙ„Ø§Ø¨ ØªÙ„ÙØ²ÙŠÙˆÙ†">Ø¯ÙˆÙ„Ø§Ø¨ ØªÙ„ÙØ²ÙŠÙˆÙ†</option>
                            <option value="Ø¯Ø±ÙŠØ³Ù†Ù‚ Ø±ÙˆÙˆÙ…">Ø¯Ø±ÙŠØ³Ù†Ù‚ Ø±ÙˆÙˆÙ…</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Ù…ØªØ±) <span style="color: #ff6b6b;">*</span></label>
                        <div class="dimension-inputs">
                            <input type="number" name="width" class="form-control" placeholder="Ø§Ù„Ø¹Ø±Ø¶" step="0.1" required>
                            <input type="number" name="height" class="form-control" placeholder="Ø§Ù„Ø§Ø±ØªÙØ§Ø¹" step="0.1" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø®Ø§Ù…Ø©</label>
                        <select id="material" class="form-control">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø§Ù…Ø©</option>
                            <option value="LG">LG</option>
                            <option value="Staron">Staron</option>
                        </select>
                    </div>

                    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ù… -->
                    <div class="form-group full-width" id="drawingGroup" style="display: none;">
                        <label>Ø§Ø±Ø³Ù… ØªØµÙ…ÙŠÙ…Ùƒ <span style="color: #ff6b6b;">*</span></label>
                        <div class="drawing-section">
                            <div class="canvas-controls">
                                <div class="brush-controls">
                                    <label>Ø­Ø¬Ù…:</label>
                                    <input type="range" id="brushSize" min="1" max="20" value="3">
                                    <input type="color" id="brushColor" value="#000000" style="width: 30px; height: 25px;">
                                </div>
                                <div class="canvas-actions">
                                    <button type="button" class="action-btn" onclick="clearCanvas()">Ù…Ø³Ø­</button>
                                </div>
                            </div>
                            <canvas id="drawingCanvas" width="600" height="400"></canvas>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="notes" class="form-control" placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©" style="min-height: 80px;"></textarea>
                    </div>
                </div>

                <button type="submit" class="btn-primary" id="submitBtn">
                    <i class="fas fa-magic"></i> Ø£Ù†Ø´Ø¦ Ø§Ù„ØªØµÙ…ÙŠÙ…
                </button>
            </form>
        </div>
    </main>

    <script>
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        let method = 'ai', isDrawing = false, hasDrawn = false, isGenerating = false;
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        // APIs Ù…ØªØ¹Ø¯Ø¯Ø© ÙƒØ¨Ø¯ÙŠÙ„
        const API_PROVIDERS = [
            {
                name: 'Pollinations AI',
                url: 'https://image.pollinations.ai/prompt/',
                method: 'GET',
                free: true
            },
            {
                name: 'DeepAI',
                url: 'https://api.deepai.org/api/text2img',
                method: 'POST',
                key: 'quickstart-QUdJIGlzIGNvbWluZy4uLi4K', // Ù…ÙØªØ§Ø­ Ù…Ø¬Ø§Ù†ÙŠ
                free: true
            },
            {
                name: 'Hugging Face',
                url: 'https://api-inference.huggingface.co/models/runwayml/stable-diffusion-v1-5',
                method: 'POST',
                key: 'YOUR_TOKEN_HERE',
                free: false
            }
        ];

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© API
        function updateAPIStatus(status, message) {
            const apiStatus = document.getElementById('apiStatus');
            apiStatus.className = `api-status ${status}`;
            apiStatus.innerHTML = message;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± APIs Ø§Ù„Ù…ØªØ§Ø­Ø©
        async function testAPIs() {
            updateAPIStatus('warning', 'ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± APIs...');
            
            // Ø§Ø®ØªØ¨Ø§Ø± Pollinations AI (Ù…Ø¬Ø§Ù†ÙŠ)
            try {
                const testUrl = 'https://image.pollinations.ai/prompt/test?width=512&height=512&nologo=true';
                const response = await fetch(testUrl, { method: 'HEAD' });
                if (response.ok) {
                    updateAPIStatus('connected', 'âœ… Pollinations AI Ù…ØªØ§Ø­');
                    return 'pollinations';
                }
            } catch (e) {
                console.log('Pollinations ØºÙŠØ± Ù…ØªØ§Ø­:', e.message);
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± DeepAI
            try {
                const response = await fetch('https://api.deepai.org/api/text2img', {
                    method: 'POST',
                    headers: { 'api-key': 'quickstart-QUdJIGlzIGNvbWluZy4uLi4K' },
                    body: JSON.stringify({ text: 'test' })
                });
                if (response.status !== 429) { // Ù„ÙŠØ³ Ù…Ø­Ø¸ÙˆØ±
                    updateAPIStatus('connected', 'âœ… DeepAI Ù…ØªØ§Ø­');
                    return 'deepai';
                }
            } catch (e) {
                console.log('DeepAI ØºÙŠØ± Ù…ØªØ§Ø­:', e.message);
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± Hugging Face
            try {
                const response = await fetch('https://huggingface.co/api/whoami', {
                    headers: { 'Authorization': 'Bearer YOUR_TOKEN_HERE' }
                });
                if (response.ok) {
                    updateAPIStatus('connected', 'âœ… Hugging Face Ù…ØªØ§Ø­');
                    return 'huggingface';
                }
            } catch (e) {
                console.log('Hugging Face ØºÙŠØ± Ù…ØªØ§Ø­:', e.message);
            }
            
            updateAPIStatus('error', 'âŒ ÙƒÙ„ APIs ØºÙŠØ± Ù…ØªØ§Ø­Ø© - Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ± Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
            return 'fallback';
        }

        // ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Pollinations AI (Ù…Ø¬Ø§Ù†ÙŠ)
        async function generateWithPollinations(prompt) {
            const cleanPrompt = encodeURIComponent(prompt.replace(/[^\w\s]/gi, ' '));
            const imageUrl = `https://image.pollinations.ai/prompt/${cleanPrompt}?width=768&height=768&nologo=true&enhance=true&model=flux`;
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙˆØ±Ø© ØªØ­Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve({ url: imageUrl, source: 'POLLINATIONS', model: 'Flux' });
                img.onerror = () => resolve(null);
                img.src = imageUrl;
            });
        }

        // ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… DeepAI
        async function generateWithDeepAI(prompt) {
            try {
                const response = await fetch('https://api.deepai.org/api/text2img', {
                    method: 'POST',
                    headers: {
                        'Api-Key': 'quickstart-QUdJIGlzIGNvbWluZy4uLi4K',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ text: prompt })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.output_url) {
                        return { url: data.output_url, source: 'DEEPAI', model: 'DeepAI' };
                    }
                }
                return null;
            } catch (e) {
                console.error('DeepAI Ø®Ø·Ø£:', e);
                return null;
            }
        }

        // ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Hugging Face
        async function generateWithHuggingFace(prompt) {
            try {
                const response = await fetch('https://api-inference.huggingface.co/models/runwayml/stable-diffusion-v1-5', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer YOUR_TOKEN_HERE',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        inputs: prompt,
                        parameters: { guidance_scale: 7.5, num_inference_steps: 20 }
                    })
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const imageUrl = URL.createObjectURL(blob);
                    return { url: imageUrl, source: 'HUGGINGFACE', model: 'Stable Diffusion v1.5' };
                }
                return null;
            } catch (e) {
                console.error('Hugging Face Ø®Ø·Ø£:', e);
                return null;
            }
        }

        // ØµÙˆØ± Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…ÙØ­Ø³Ù†Ø©
        function getFallbackImage(prompt) {
            const type = document.getElementById('projectType')?.value || 'Ù…Ø·Ø¨Ø®';
            const variants = 3;
            const random = Math.floor(Math.random() * variants);
            
            const fallbackImages = {
                'Ù…Ø·Ø¨Ø®': [
                    'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1565538810643-b5bdb714032a?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=768&h=768&fit=crop&crop=center&auto=format&q=80'
                ],
                'Ù…ØºØ³Ù„Ø©': [
                    'https://images.unsplash.com/photo-1620626011761-996317b8d101?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1584622781564-1d987ba8943e?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1552321554-5fefe8c9ef14?w=768&h=768&fit=crop&crop=center&auto=format&q=80'
                ],
                'ÙƒØ§ÙˆÙ†ØªØ±': [
                    'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1497366216548-37526070297c?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=768&h=768&fit=crop&crop=center&auto=format&q=80'
                ],
                'Ø¯ÙˆÙ„Ø§Ø¨ ØªÙ„ÙØ²ÙŠÙˆÙ†': [
                    'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1554995207-c18c203602cb?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1493809842364-78817add7ffb?w=768&h=768&fit=crop&crop=center&auto=format&q=80'
                ],
                'Ø¯Ø±ÙŠØ³Ù†Ù‚ Ø±ÙˆÙˆÙ…': [
                    'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1631889993959-41b4e9c6e3c5?w=768&h=768&fit=crop&crop=center&auto=format&q=80',
                    'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=768&h=768&fit=crop&crop=center&auto=format&q=80'
                ]
            };
            
            const selectedImages = fallbackImages[type] || fallbackImages['Ù…Ø·Ø¨Ø®'];
            const imageUrl = selectedImages[random];
            
            return { 
                url: imageUrl, 
                source: 'FALLBACK', 
                model: 'Unsplash Professional',
                type: type,
                variant: random + 1
            };
        }

        // Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªÙˆÙ„ÙŠØ¯
        async function callAI(prompt) {
            console.log('ğŸ¤– Ø¨Ø¯Ø¡ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹:', prompt);
            
            // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Øµ
            const enhancedPrompt = `${prompt}, professional interior design, architectural visualization, high quality, realistic, modern corian surfaces`;
            
            // ØªØ¬Ø±Ø¨Ø© APIs Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨
            let result = null;
            
            // 1. Pollinations AI (Ù…Ø¬Ø§Ù†ÙŠ ÙˆØ³Ø±ÙŠØ¹)
            updateAPIStatus('warning', 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ Pollinations...');
            result = await generateWithPollinations(enhancedPrompt);
            if (result) {
                updateAPIStatus('connected', 'âœ… Ù†Ø¬Ø­ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ Pollinations AI');
                return result;
            }
            
            // 2. DeepAI (Ù…Ø¬Ø§Ù†ÙŠ Ù„ÙƒÙ† Ù…Ø­Ø¯ÙˆØ¯)
            updateAPIStatus('warning', 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ DeepAI...');
            result = await generateWithDeepAI(enhancedPrompt);
            if (result) {
                updateAPIStatus('connected', 'âœ… Ù†Ø¬Ø­ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ DeepAI');
                return result;
            }
            
            // 3. Hugging Face (ÙŠØ­ØªØ§Ø¬ ØªÙˆÙƒÙ† ØµØ­ÙŠØ­)
            updateAPIStatus('warning', 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ Hugging Face...');
            result = await generateWithHuggingFace(enhancedPrompt);
            if (result) {
                updateAPIStatus('connected', 'âœ… Ù†Ø¬Ø­ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹ Hugging Face');
                return result;
            }
            
            // 4. Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            updateAPIStatus('error', 'âš ï¸ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ± Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©');
            return getFallbackImage(prompt);
        }

        // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©
        function chooseMethod(m) {
            method = m;
            const ai = document.getElementById('aiSection');
            const form = document.querySelector('.form-container');
            const draw = document.getElementById('drawingGroup');
            const aiBtn = document.getElementById('chooseAI');
            const drawBtn = document.getElementById('chooseDraw');
            
            if (m === 'ai') {
                ai.style.display = 'block';
                draw.style.display = 'none';
                form.classList.remove('show');
                aiBtn.classList.add('active');
                drawBtn.classList.remove('active');
            } else {
                ai.style.display = 'none';
                draw.style.display = 'block';
                form.classList.add('show');
                drawBtn.classList.add('active');
                aiBtn.classList.remove('active');
            }
        }

        // ØªÙˆÙ„ÙŠØ¯ AI Ù…Ø­Ø³Ù†
        async function generateAI() {
            if (isGenerating) return;
            const prompt = document.getElementById('aiPrompt').value.trim();
            if (!prompt || prompt.length < 10) { 
                alert('Ø§ÙƒØªØ¨ ÙˆØµÙ Ø£Ø·ÙˆÙ„ Ù„Ù„ØªØµÙ…ÙŠÙ…'); 
                return; 
            }
            
            isGenerating = true;
            const btn = document.querySelector('.ai-generate-btn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯...';
            btn.disabled = true;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            document.getElementById('aiResult').classList.remove('show');
            
            console.log('ğŸ¨ Ø¨Ø¯Ø¡ ØªÙˆÙ„ÙŠØ¯ AI Ù„Ù„ÙˆØµÙ:', prompt);
            const result = await callAI(prompt);
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ù…ØµØ¯Ø±
            const getSourceInfo = (source) => {
                switch(source) {
                    case 'POLLINATIONS':
                        return { color: '#4CAF50', icon: 'ğŸ¤–', text: 'ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ!', desc: 'Ù…ÙˆÙ„Ø¯ Ø¨Ù€ Pollinations AI Ù…Ø¬Ø§Ù†Ø§Ù‹' };
                    case 'DEEPAI':
                        return { color: '#2196F3', icon: 'ğŸ¨', text: 'ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù€ DeepAI!', desc: 'Ù…ÙˆÙ„Ø¯ Ø¨Ù€ DeepAI API' };
                    case 'HUGGINGFACE':
                        return { color: '#FF9800', icon: 'ğŸ¤–', text: 'ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù€ Hugging Face!', desc: 'Ù…ÙˆÙ„Ø¯ Ø¨Ù€ Stable Diffusion' };
                    default:
                        return { color: '#9E9E9E', icon: 'ğŸ“·', text: 'ØµÙˆØ±Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©', desc: 'ØµÙˆØ±Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…ÙØ®ØªØ§Ø±Ø©' };
                }
            };
            
            const sourceInfo = getSourceInfo(result.source);
            
            document.getElementById('aiImageContainer').innerHTML = `
                <div style="background: rgba(255,255,255,0.1); border: 2px solid ${sourceInfo.color}; border-radius: 15px; padding: 20px; margin: 20px 0;">
                    <h4 style="color: ${sourceInfo.color}; text-align: center; margin-bottom: 15px;">
                        ${sourceInfo.icon} ${sourceInfo.text}
                    </h4>
                    
                    <div style="background: rgba(0,0,0,0.4); padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; color: #fff; font-size: 0.85rem;">
                            <div><strong>Ø§Ù„Ù…ØµØ¯Ø±:</strong><br>${result.source}</div>
                            <div><strong>Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:</strong><br>${result.model}</div>
                            <div><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong><br>${result.source === 'FALLBACK' ? 'Ø§Ø­ØªÙŠØ§Ø·ÙŠ' : 'Ù…ÙˆÙ„Ø¯'}</div>
                            ${result.type ? `<div><strong>Ø§Ù„Ù†ÙˆØ¹:</strong><br>${result.type}</div>` : ''}
                        </div>
                        <p style="margin-top: 10px; font-size: 0.8rem; opacity: 0.8;">${sourceInfo.desc}</p>
                    </div>
                    
                    <img src="${result.url}" alt="Ø§Ù„ØªØµÙ…ÙŠÙ…" style="max-width: 100%; border-radius: 10px; display: block; margin: 0 auto; border: 2px solid ${sourceInfo.color};">
                    
                    <div style="background: rgba(${result.source === 'FALLBACK' ? '158, 158, 158' : '76, 175, 80'}, 0.15); padding: 15px; border-radius: 10px; margin-top: 15px; text-align: center;">
                        <p style="color: #fff; margin: 0;">
                            ${result.source === 'FALLBACK' ? 
                                'ğŸ’¡ ØµÙˆØ±Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…ÙØ®ØªØ§Ø±Ø© - Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØµÙ…ÙŠÙ… Ù…Ø®ØµØµ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª' : 
                                'âœ¨ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø®ØµÙŠØµØ§Ù‹ Ù„Ùƒ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ!'
                            }
                        </p>
                    </div>
                </div>
            `;
            
            document.getElementById('aiResult').classList.add('show');
            document.querySelector('.form-container').classList.add('show');
            
            btn.innerHTML = '<i class="fas fa-magic"></i> ÙˆÙ„Ù‘Ø¯ ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯';
            btn.disabled = false;
            isGenerating = false;
            
            console.log('âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªÙˆÙ„ÙŠØ¯:', result.source, '-', result.model);
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø³Ù…
        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: (e.clientX - rect.left) * (canvas.width / rect.width),
                y: (e.clientY - rect.top) * (canvas.height / rect.height)
            };
        }

        function startDraw(e) {
            isDrawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
            hasDrawn = true;
        }

        function draw(e) {
            if (!isDrawing) return;
            const pos = getPos(e);
            ctx.lineWidth = document.getElementById('brushSize').value;
            ctx.strokeStyle = document.getElementById('brushColor').value;
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function stopDraw() { 
            isDrawing = false; 
            ctx.beginPath(); 
        }
        
        function clearCanvas() { 
            ctx.clearRect(0, 0, canvas.width, canvas.height); 
            hasDrawn = false; 
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ù… Ø¨Ù€ AI
        async function processDrawing() {
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù€ AI...';
            btn.disabled = true;
            
            console.log('ğŸ¨ Ø¨Ø¯Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„ÙŠØ¯ÙˆÙŠ');
            
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
            const existingComparisons = document.querySelectorAll('[data-comparison]');
            existingComparisons.forEach(comp => comp.remove());
            
            const type = document.getElementById('projectType').value || 'furniture';
            const material = document.getElementById('material').value || 'corian';
            const width = document.querySelector('input[name="width"]').value || '2';
            const height = document.querySelector('input[name="height"]').value || '1';
            
            // prompt Ù…Ø­Ø³Ù† Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            let specificPrompt = '';
            switch(type) {
                case 'Ù…Ø·Ø¨Ø®':
                    specificPrompt = `modern kitchen design with ${material} countertops, cabinets, interior design`;
                    break;
                case 'Ù…ØºØ³Ù„Ø©':
                    specificPrompt = `bathroom vanity with ${material} countertop, modern sink, mirrors, bathroom interior`;
                    break;
                case 'ÙƒØ§ÙˆÙ†ØªØ±':
                    specificPrompt = `reception counter made of ${material}, office lobby, commercial interior`;
                    break;
                case 'Ø¯ÙˆÙ„Ø§Ø¨ ØªÙ„ÙØ²ÙŠÙˆÙ†':
                    specificPrompt = `TV unit cabinet with ${material} surfaces, entertainment center, living room`;
                    break;
                case 'Ø¯Ø±ÙŠØ³Ù†Ù‚ Ø±ÙˆÙˆÙ…':
                    specificPrompt = `walk-in closet with ${material} surfaces, wardrobe design, dressing room`;
                    break;
                default:
                    specificPrompt = `${type} furniture with ${material} material, interior design`;
            }
            
            const fullPrompt = `${specificPrompt}, dimensions ${width}m x ${height}m, photorealistic, architectural visualization, professional interior design, clean modern style`;
            
            console.log('ğŸ“ Prompt Ù„Ù„Ø±Ø³Ù…:', fullPrompt);
            
            const result = await callAI(fullPrompt);
            showComparison(result, fullPrompt);
            
            btn.innerHTML = '<i class="fas fa-magic"></i> Ø£Ù†Ø´Ø¦ Ø§Ù„ØªØµÙ…ÙŠÙ…';
            btn.disabled = false;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
        function showComparison(aiResult, prompt) {
            const container = document.createElement('div');
            container.setAttribute('data-comparison', 'true');
            
            const getSourceInfo = (source) => {
                switch(source) {
                    case 'POLLINATIONS':
                        return { color: '#4CAF50', icon: 'ğŸ¤–', text: 'ØªÙ… Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù€ Pollinations AI!' };
                    case 'DEEPAI':
                        return { color: '#2196F3', icon: 'ğŸ¨', text: 'ØªÙ… Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù€ DeepAI!' };
                    case 'HUGGINGFACE':
                        return { color: '#FF9800', icon: 'ğŸ¤–', text: 'ØªÙ… Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø¨Ù€ Hugging Face!' };
                    default:
                        return { color: '#9E9E9E', icon: 'ğŸ“·', text: 'ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…ÙØ®ØªØ§Ø±' };
                }
            };
            
            const sourceInfo = getSourceInfo(aiResult.source);
            
            container.innerHTML = `
                <div style="background: rgba(255,255,255,0.08); border: 2px solid ${sourceInfo.color}; border-radius: 20px; padding: 30px; margin: 30px 0; text-align: center;">
                    <h3 style="color: ${sourceInfo.color}; margin-bottom: 20px;">${sourceInfo.icon} ${sourceInfo.text}</h3>
                    
                    <div style="background: rgba(0,0,0,0.4); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; color: #fff; font-size: 0.85rem;">
                            <div><strong>Ø§Ù„Ù…ØµØ¯Ø±:</strong><br>${aiResult.source}</div>
                            <div><strong>Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:</strong><br>${aiResult.model}</div>
                            <div><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong><br>${aiResult.source === 'FALLBACK' ? 'Ø§Ø­ØªÙŠØ§Ø·ÙŠ' : 'Ù…ÙˆÙ„Ø¯'}</div>
                            ${aiResult.type ? `<div><strong>Ø§Ù„Ù†ÙˆØ¹:</strong><br>${aiResult.type}</div>` : ''}
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div>
                            <h4 style="color: #C4965A; margin-bottom: 10px;">âœï¸ Ø±Ø³Ù…ØªÙƒ Ø§Ù„Ø£ØµÙ„ÙŠØ©</h4>
                            <canvas id="original${Date.now()}" width="300" height="200" style="border: 2px solid #666; border-radius: 10px; background: white; max-width: 100%;"></canvas>
                        </div>
                        <div>
                            <h4 style="color: #C4965A; margin-bottom: 10px;">${sourceInfo.icon} Ø§Ù„ØªØµÙ…ÙŠÙ… ${aiResult.source === 'FALLBACK' ? 'Ø§Ù„Ù…Ù‚ØªØ±Ø­' : 'Ø§Ù„Ù…ÙˆÙ„Ø¯'}</h4>
                            <img src="${aiResult.url}" style="max-width: 100%; border: 2px solid ${sourceInfo.color}; border-radius: 10px;">
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,191,36,0.15); border: 2px solid rgba(255,191,36,0.4); border-radius: 15px; padding: 20px; margin: 20px 0;">
                        <h3 style="color: #fbbf24; margin-bottom: 15px;">Ù‡Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ… Ù…Ù†Ø§Ø³Ø¨ØŸ</h3>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            <button onclick="approve('${aiResult.url}', '${prompt}', '${aiResult.source}', '${aiResult.model}')" style="background: #22c55e; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold;">âœ… Ù…ÙˆØ§ÙÙ‚ - Ø£Ø±Ø³Ù„</button>
                            <button onclick="reject()" style="background: #ef4444; color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold;">âŒ Ø£Ø¹ÙŠØ¯ Ø§Ù„Ø±Ø³Ù…</button>
                        </div>
                    </div>
                    
                    <div style="background: rgba(59,130,246,0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem;">
                            ğŸ’¡ <strong>Ù†ØµÙŠØ­Ø©:</strong> ${aiResult.source === 'FALLBACK' ? 
                                'Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØµÙ…ÙŠÙ… Ù…Ø®ØµØµØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰' : 
                                'ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø­ØµØ±ÙŠØ§Ù‹ Ù…Ù† Ø±Ø³Ù…ØªÙƒ!'
                            }
                        </p>
                    </div>
                </div>
            `;
            
            document.querySelector('.form-container').appendChild(container);
            
            // Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ù…Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
            const original = container.querySelector('canvas');
            const originalCtx = original.getContext('2d');
            originalCtx.drawImage(canvas, 0, 0, 300, 200);
            
            container.scrollIntoView({ behavior: 'smooth' });
            console.log('ğŸ“‹ Ø¹Ø±Ø¶ Ù…Ù‚Ø§Ø±Ù†Ø©:', aiResult.source, '-', aiResult.model);
        }

        // Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
        function approve(imageUrl, prompt, source, model) {
            const confirmText = source === 'FALLBACK' ? 
                'ğŸ“· Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ®ØµØµ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ØŸ' : 
                'ğŸ¤– Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ÙˆÙ„Ø¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ØŸ';
                
            if (confirm(confirmText)) {
                sendWhatsApp('ai_enhanced', { imageUrl, prompt, source, model });
                const comparison = document.querySelector('[data-comparison]');
                if (comparison) comparison.remove();
                console.log('âœ… ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰:', source, '-', model);
            }
        }

        // Ø±ÙØ¶
        function reject() {
            const comparisons = document.querySelectorAll('[data-comparison]');
            comparisons.forEach(comp => comp.remove());
            
            alert('ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© Ø£ÙØ¶Ù„:\n\nâœï¸ Ø§Ø±Ø³Ù… Ø¨ØªÙØ§ØµÙŠÙ„ Ø£ÙˆØ¶Ø­ ÙˆØ®Ø·ÙˆØ· Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©\nğŸ¯ Ø£Ùˆ Ø¬Ø±Ø¨ Ø§Ù„ÙˆØµÙ Ø§Ù„Ù†ØµÙŠ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ\nğŸ”„ ÙƒÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø³ØªØ¹Ø·ÙŠ Ù†ØªÙŠØ¬Ø© Ù…Ø®ØªÙ„ÙØ©\nğŸŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØµØ§Ù…ÙŠÙ… Ù…Ø®ØµØµØ©');
            
            canvas.scrollIntoView({ behavior: 'smooth' });
            console.log('âŒ ØªÙ… Ø±ÙØ¶ Ø§Ù„ØªØµÙ…ÙŠÙ…');
        }

        // Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨
        function sendWhatsApp(type, data) {
            const name = document.getElementById('customerName').value;
            const location = document.getElementById('location').value || 'Ø§Ù„ÙƒÙˆÙŠØª';
            const projectType = document.getElementById('projectType').value;
            const whatsapp = document.getElementById('whatsapp').value;
            const width = document.querySelector('input[name="width"]').value;
            const height = document.querySelector('input[name="height"]').value;
            const material = document.getElementById('material').value;
            const notes = document.getElementById('notes').value;
            
            let message = `ğŸ¨ *Ø·Ù„Ø¨ ØªØµÙ…ÙŠÙ… - ÙƒÙˆØ±ÙŠØ§Ù† ÙƒØ§Ø³ÙŠÙ„*\n\n`;
            message += `ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${name}\n`;
            message += `ğŸ“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${location}\n`;
            message += `ğŸ—ï¸ Ø§Ù„Ù†ÙˆØ¹: ${projectType}\n`;
            message += `ğŸ“ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯: ${width}Ù… Ã— ${height}Ù…\n`;
            if (material) message += `ğŸ§± Ø§Ù„Ø®Ø§Ù…Ø©: ${material}\n`;
            message += `ğŸ“ ÙˆØ§ØªØ³Ø§Ø¨: ${whatsapp}\n\n`;
            
            if (type === 'ai') {
                message += `ğŸ¤– *ÙˆØµÙ AI:* "${data}"\n\n`;
            } else if (type === 'ai_enhanced') {
                message += `ğŸ¨ *ØªØµÙ…ÙŠÙ… Ù…Ù† Ø±Ø³Ù…Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„*\n`;
                message += `ğŸ“ *Ø§Ù„Ù…ØµØ¯Ø±:* ${data.source}\n`;
                message += `ğŸ¤– *Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:* ${data.model}\n`;
                message += `ğŸ“¸ *Ø±Ø§Ø¨Ø· Ø§Ù„ØªØµÙ…ÙŠÙ…:* ${data.imageUrl}\n\n`;
            }
            
            if (notes) message += `ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${notes}\n\n`;
            message += `â° ${new Date().toLocaleString('ar-KW')}\n`;
            message += `ğŸ”§ Ù…ÙˆÙ„Ø¯ Ø¨Ù€: ${data?.source || 'AI'}`;
            
            const url = `https://wa.me/96599123456?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
            alert('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
            document.getElementById('designForm').reset();
            clearCanvas();
            console.log('ğŸ“± ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:', type);
        }

        // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDraw);
        canvas.addEventListener('mouseout', stopDraw);

        // Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
        canvas.addEventListener('touchstart', e => { e.preventDefault(); startDraw(e.touches[0]); });
        canvas.addEventListener('touchmove', e => { e.preventDefault(); draw(e.touches[0]); });
        canvas.addEventListener('touchend', e => { e.preventDefault(); stopDraw(); });

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('designForm').addEventListener('submit', e => {
            e.preventDefault();
            
            const name = document.getElementById('customerName').value.trim();
            const type = document.getElementById('projectType').value;
            const phone = document.getElementById('whatsapp').value.trim();
            
            if (!name || !type || !phone) { 
                alert('Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'); 
                return; 
            }
            
            if (method === 'ai') {
                const prompt = document.getElementById('aiPrompt').value.trim();
                if (!prompt) { alert('ÙˆÙ„Ù‘Ø¯ ØªØµÙ…ÙŠÙ… AI Ø£ÙˆÙ„Ø§Ù‹'); return; }
                sendWhatsApp('ai', prompt);
            } else {
                if (!hasDrawn) { alert('Ø§Ø±Ø³Ù… ØªØµÙ…ÙŠÙ…Ùƒ Ø£ÙˆÙ„Ø§Ù‹'); return; }
                processDrawing();
            }
        });

        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
        document.getElementById('whatsapp').addEventListener('input', e => {
            let val = e.target.value.replace(/\D/g, '');
            if (val && !val.startsWith('965')) val = '965' + val;
            e.target.value = val;
        });

        // Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„ØªÙ‡ÙŠØ¦Ø©
        async function initialize() {
            chooseMethod('ai');
            console.log('âœ… ÙƒÙˆØ±ÙŠØ§Ù† ÙƒØ§Ø³ÙŠÙ„ Ø¬Ø§Ù‡Ø²');
            
            // Ø§Ø®ØªØ¨Ø§Ø± APIs Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            const availableAPI = await testAPIs();
            console.log('ğŸ“¡ API Ù…ØªØ§Ø­:', availableAPI);
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        initialize();
    </script>
</body>
</html>